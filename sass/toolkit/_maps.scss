// Map Toolkit
// ===========

// Truncate List
// -------------
// Return a list, truncated to a given length
@function truncate-list(
  $list,
  $length
) {
  $return: ();

  @for $i from 1 through length($list) {
    $return: if($i <= $length, append($return, nth($list, $i)), $return);
  }

  @return $return;
}

// Get Deep
// --------
// Return a value deep in nested maps
@function deep-get(
  $map,
  $keys...
) {
  $return: $map;

  @each $key in $keys {
    @if type-of($return) == map {
      $return: map-get($return, $key);
    } @else {
      @warn "#{$return} is not a map for #{$key}.";
    }
  }

  @return $return;
}

// Set Deep
// --------
// Set a value deep in nested maps
@function deep-set(
  $map,
  $keys,
  $value
) {
  $length: length($keys);
  $return: ();

  @for $i from 1 through $length {
    $n: 0 - $i;
    $level: truncate-list($keys, $length + $n);
    $level: deep-get($map, $level...);
    $merge: (nth($keys, $n): $value);
    $value: map-merge($level, $merge);
    $return: $value;
  }

  @return $return;
}
